<html>
<head>
  <title>Evernote Export</title>
  <basefont face="楷体" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/268868 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: 楷体;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="1360"/>
<h1>lucene基础知识</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div><font color="#E30000">串Lucene知识点思路：</font></div><div><font color="#E30000"><br></font></div><div><font color="#E30000"><br></font></div><div><span style="color: rgb(227, 0, 0);">注：在MyEclipse中可以通过Ctrl+Shift+R和通配符查询相关的资源。</span></div><div><font color="#E30000"><br></font><div><font color="#1C3387"><b>1、全文检索的概念</b></font></div><div><font color="#E30000">&lt;1&gt;从大量的信息中快速、准确地查找出要的信息。</font></div><div><font color="#E30000">&lt;2&gt;搜索的内容是文本信息（不是多媒体）。</font></div><div><font color="#E30000">&lt;3&gt;根据文本的关键词进行搜索，而不是根据语义进行搜索。</font></div><div><font color="#E30000">&lt;4&gt;全面、快速、准确是衡量全文检索系统的关键指标。</font></div><div><font color="#E30000">&lt;5&gt;搜索时英文不区分大小写。</font></div><div><font color="#E30000">&lt;6&gt;结果列表由相关度排序。</font></div><div><font color="#E30000">&lt;7&gt;全文搜索有站内搜索和垂直搜索</font></div><div><font color="#E30000"><br></font></div><div><font color="#E30000"><br></font></div><div><font color="#1C3387"><b>2、全文搜索与数据搜索的区别</b></font></div><div><font color="#E30000">数据库搜索的缺点：</font></div><div><font color="#E30000">&lt;1&gt;搜索效果比较差。</font></div><div><font color="#E30000">&lt;2&gt;在搜索的结果中，有大量的数据被搜索出来，有很多数据是没有用的。</font></div><div><font color="#E30000">&lt;3&gt;查询速度在大量的情况下是很难做到快速的。</font></div><div><font color="#E30000"><br></font></div><div><font color="#E30000"><br></font></div><div><font color="#1C3387"><b>3、互联网搜索结构图</b></font></div><div><img src="lucene基础知识_files/Image.png" type="image/png" height="291" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="451"/></div><div><span style="color: rgb(227, 0, 0);">由上图可以看出，互联网搜索就是利用爬虫搜索信息并且在索引库中建立索引，这样索引库中的信息就可能与网络上的网页信息不一致，从而导致有时候利用引擎搜索的网页会找不到相关的网站。</span></div><div><span style="color: rgb(227, 0, 0);"><br></span></div><div><span style="color: rgb(227, 0, 0);"><br></span></div><div><font color="#1C3387"><b>4、lucene的大致结构框图</b></font></div><div><img src="lucene基础知识_files/Image [1].png" type="image/png" height="306" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="480"/></div><div><span style="color: rgb(227, 0, 0);">由上图可以看出，利用</span><font color="#E30000">lucene</font><span style="color: rgb(227, 0, 0);">的api进行增删改操作其实就是对索引库的操作。查询操作就是根据索引库的索引查询出内容然后返回。在存入索引库的时候，其实是存入对象的某些字段及其值，并且转换为Document，然后存入索引库。</span></div><div><span style="color: rgb(227, 0, 0);"><br></span></div><div><span style="color: rgb(227, 0, 0);"><br></span></div><div><font color="#1C3387"><b>5、lucene建立索</b></font><b style="color: rgb(28, 51, 135);">引图</b></div><div><img src="lucene基础知识_files/Image [2].png" type="image/png" height="384" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="670"/></div><div><br></div><div><br></div><div><font color="#1C3387"><b>6、使用lucene</b></font></div><div><font color="#E30000">lucene的核心jar包有：</font></div><div><font color="#E30000">(核心包)lucene-core-3.0.1.jar</font></div><div><font color="#E30000">(分词器)lucene-analyzers-3.1.0.jar</font></div><div><font color="#E30000">(高亮器)lucene-highlighter-3.1.0.jar</font></div><div><font color="#E30000">lucene-memory-3.1.0.jar</font></div><div><font color="#E30000"><br></font></div><div><font color="#E30000">&lt;1&gt;导入核心jar包</font></div><div><font color="#E30000">&lt;2&gt;创建一个需要用lucene进行操作的类</font></div><div><font color="#E30000">&lt;3&gt;利用lucene的API操作此类的对象。</font></div><div><font color="#E30000">cn.itheima.lucene.bean.Article.java</font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Article {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>private</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Long</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">id</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>private</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">title</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>private</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">content</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Long getId() {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">id</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">setId(Long id) {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">id</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">= id;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String getTitle() {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">title</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">setTitle(String title) {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">title</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">= title;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String getContent() {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">content</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">setContent(String content) {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">content</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">= content;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div><font color="#E30000">cn.itheima.lucene.test.LuceneTest.java</font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">1、创建article对象，并把该对象放入到索引库中</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">2、根据关键词检索article对象</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">LuceneTest {</span></font></font></div><div align="left"><div align="left"><font color="#6A0081">       <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">1、创建article对象</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">2、创建indexWriter对象</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">3、把article对象写入到索引库中</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testCreateIndex()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Article article =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Article();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            article.setId(1L);</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setTitle(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene可以用来做搜索引擎&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setContent(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;baidu、google搜索引擎公司&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Directory directory = FSDirectory.</span> <span style="font-size:10pt"><i>open</i></span><span style="font-size:10pt">(</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">File(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;./indexDir&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Analyzer analyzer =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">StandardAnalyzer(Version.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LUCENE_30</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//MaxFieldLength限制字段内容的大小</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexWriter indexWriter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexWriter(directory,analyzer,MaxFieldLength.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LIMITED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Document document =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Document();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">        </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//name代表存放在索引库中的名称   </span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Field field1 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Field(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;id&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,article.getId().toString(),Store.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>YES</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,Index.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>NOT_ANALYZED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Field field2 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Field(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,article.getTitle(),Store.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>YES</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,Index.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>ANALYZED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Field field3 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Field(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,article.getContent(),Store.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>YES</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,Index.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>ANALYZED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            document.add(field1);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            document.add(field2);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            document.add(field3);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.addDocument(document);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.close();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="lucene基础知识_files/Image [3].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><br></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">cn.itheima.lucene.test.LuceneTest.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font><font face="Courier New" size="2"> </font><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">LuceneTest {</span></font></font></div><div align="left"><font color="#6A0081">     <span style="font-size: 10pt; font-family: 'Courier New';">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testSearch()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Directory directory = FSDirectory.</span> <span style="font-size:10pt"><i>open</i></span><span style="font-size:10pt">(</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">File(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;./indexDir&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexSearcher indexSearcher =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexSearcher(directory);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Analyzer analyzer =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">StandardAnalyzer(Version.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LUCENE_30</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            QueryParser queryParser =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">QueryParser(Version.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LUCENE_30</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,analyzer);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//关键字</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query = queryParser.parse(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//TopDocs代表目录库的引用</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            TopDocs topDocs = indexSearcher.search(query,1);</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//根据关键词搜索出来的总的记录数</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">totalHits = topDocs.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">totalHits</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            ScoreDoc[] scoreDocs = topDocs.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">scoreDocs</span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            List&lt;Article&gt; articles =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ArrayList&lt;Article&gt;();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(ScoreDoc scoreDoc : scoreDocs){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//关键词对应的索引值</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">index = scoreDoc.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">doc</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//相关度得分</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>float</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">score = scoreDoc.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">score</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Document doc = indexSearcher.doc(index);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  Article article =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Article();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  article.setId(Long.</span> <span style="font-size:10pt"><i>parseLong</i></span><span style="font-size:10pt">(doc.get(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;id&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  article.setTitle(doc.get(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  article.setContent(doc.get(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  articles.add(article);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Article article : articles){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(article.getId() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getTitle() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getContent());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      } </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">}</span></font></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;"><br></span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="lucene基础知识_files/Image [4].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><br></div><div><span style="text-align: -webkit-auto;"><font color="#1C3387"><b>7、改写上面的程序</b></font></span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">cn.itheima.lucene.utils.DocumentUtils.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">DocumentUtils {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>static</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Document article2Document(</span><span style="font-size:10pt; background:#d4d4d4">Article</span> <span style="font-size:10pt">article){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Document document =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Document();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Field field1 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Field(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;id&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,article.getId().toString(),Store.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>YES</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,Index.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>NOT_ANALYZED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Field field2 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Field(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,article.getTitle(),Store.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>YES</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,Index.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>ANALYZED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Field field3 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Field(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,article.getContent(),Store.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>YES</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,Index.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>ANALYZED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            document.add(field1);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            document.add(field2);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            document.add(field3);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">document;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>static</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">Article</span> <span style="font-size:10pt">document2Article(Document document){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span> <span style="font-size:10pt; background:#d4d4d4">Article</span> <span style="font-size:10pt">article =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">Article</span> <span style="font-size:10pt">();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setId(Long.</span> <span style="font-size:10pt"><i>parseLong</i></span><span style="font-size:10pt">(document.get(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;id&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setTitle(document.get(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setContent(document.get(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">article;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">cn.itheima.lucene.utils.LuceneUtils.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">LuceneUtils {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>static</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Directory</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>static</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Analyzer</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>static</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">{</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>try</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">{</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">= FSDirectory.</span><span style="font-size:10pt"><i>open</i></span><span style="font-size:10pt">(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">File(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;./indexDir&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">StandardAnalyzer(Version.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LUCENE_30</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            }</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>catch</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">(Exception e) {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  e.printStackTrace();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">cn.itheima.lucene.test.LuceneTest.java</span></div><div align="left"><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">LuceneTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testCreateIndex()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Article article =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Article();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            article.setId(1L);</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setTitle(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene可以用来做搜索引擎&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setContent(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;baidu、google搜索引擎公司&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexWriter indexWriter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexWriter(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,MaxFieldLength.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>LIMITED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            Document document = DocumentUtils.</span> <span style="font-size:10pt"><i>article2Document</i></span><span style="font-size:10pt">(article);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.addDocument(document);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.close();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testSearch()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexSearcher indexSearcher =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexSearcher(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            QueryParser queryParser =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">MultiFieldQueryParser(Version.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LUCENE_30</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String[]{</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">},LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query = queryParser.parse(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            TopDocs topDocs = indexSearcher.search(query,3);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            ScoreDoc[] scoreDocs = topDocs.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">scoreDocs</span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            List&lt;Article&gt; articles =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ArrayList&lt;Article&gt;();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(ScoreDoc scoreDoc : scoreDocs){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">index = scoreDoc.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">doc</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Document doc = indexSearcher.doc(index);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Article article = DocumentUtils.</span> <span style="font-size:10pt"><i>document2Article</i></span><span style="font-size:10pt">(doc);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  articles.add(article);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Article article : articles){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(article.getId() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getTitle() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getContent());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果： </span></div><div><img src="lucene基础知识_files/Image [5].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><br></div><div><font color="#2D4FC9"><b>8、删除数据</b></font></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">Term就是对关键词的对象封装，包含两个属性：field、text。</span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">LuceneTest.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">LuceneTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">删除并不是把原来的cfs文件删除掉了，而是把原来的基础上多了一个del文件。</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testDelete()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexWriter indexWriter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexWriter(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,MaxFieldLength.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>LIMITED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Term term =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Term(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.deleteDocuments(term);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.close();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><b style="color: rgb(45, 79, 201);">9、更新操作</b></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">LuceneTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testUpdate()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexWriter indexWriter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexWriter(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,MaxFieldLength.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>LIMITED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Term term =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Term(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Article article =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Article();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            article.setId(1L);</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setTitle(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene可以用来做搜索引擎&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setContent(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;baidu搜索引擎公司&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><div align="left"><font color="#6A0081">            <font face="Courier New" size="2"><span style="font-size:10pt; background:#e8f2fe">//Term为删除，Document为增加</span></font></font></div></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.updateDocument(term, DocumentUtils.</span><span style="font-size:10pt"><i>article2Document</i></span><span style="font-size:10pt">(article));</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.close();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><font color="#6A0081">}</font><br><br></span></font><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果： </span></div><div><img src="lucene基础知识_files/Image [6].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><img src="lucene基础知识_files/Image [7].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">总结：</span><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">更新操作实际上是先删除后增加。</span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;"><br></span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;"><br></span></div><div><span style="text-align: -webkit-auto;"><font color="#1C3387"><b>10、保持数据库与索引库的同步</b></font></span></div><div><img src="lucene基础知识_files/Image [8].png" type="image/png" height="195" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="424"/></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">在一个系统中，如果索引功能存在，那么数据库和索引库应该是同时存在的。这个时候需要保证索引库的数据和数据库中的数据保持一致性。可以在数据库进行增删改操作的时候对索引库也进行相应的操作。这样就可以保证数据库与索引库的一致性。</span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;"><br></span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;"><br></span></div><div style="text-align: -webkit-auto;"><font color="#1C3387"><b>11、同一个索引库不能同时存在两个IndexWriter</b></font></div><div style="text-align: -webkit-auto;"><font color="#E30000">cn.itheima.lucene.test.IndexWriterTest.java</font></div><div style="text-align: -webkit-auto;"><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexWriterTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">test</span> <span style="font-size:10pt">()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexWriter indexWriter1 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexWriter(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,MaxFieldLength.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>LIMITED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexWriter indexWriter2 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexWriter(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,MaxFieldLength.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>LIMITED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="lucene基础知识_files/Image [9].png" type="image/png" height="89" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="780"/></div><div><img src="lucene基础知识_files/Image [10].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">总结：&lt;1&gt;由上图可见，只要有一个IndexWriter操作索引库，那么它就会对索引库加锁，只要这个indexWriter没有关闭从而解锁，那么其他的IndexWriter和IndexSearch就无法访问索引库。如果使用了IndexSearch去查询索引库，也获取不了任何东西。</span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">&lt;2&gt;当indexWriter关闭的时候，释放IO流的资源并且释放锁。</span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">&lt;3&gt;索引库的最多的操作是检索，后台维护的操作还是比较少的，所以不需要很多的IndexWriter。</span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;"><br></span></div><div style="text-align: -webkit-auto;"><font color="#1C3387"><b><br></b></font></div><div><span style="text-align: -webkit-auto;"><font color="#1C3387"><b>12、索引库的优化</b></font></span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">如果执行了多次上面的testCreateIndex,就会出现如下图所示的情况。</span></div><div><img src="lucene基础知识_files/Image [11].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">一般情况下，只要达到一定数目的cfs文件，那么lucene就会自动合并cfs文件从而达到优化的目的。不过有时候，需要手动进行优化。 </span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;"><br></span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">cn.itheima.lucene.test.IndexWriterTest.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">LuceneTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testOptimize()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">Exception</span> <span style="font-size:10pt">{</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexWriter indexWriter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">IndexWriter</span><span style="font-size:10pt">(LuceneUtils.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,MaxFieldLength.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LIMITED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.</span> <span style="font-size:10pt; background:#d4d4d4">optimize</span><span style="font-size:10pt">();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.close();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;"><br></span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="lucene基础知识_files/Image [12].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div></div></div><div style="text-align: -webkit-auto;"><font color="#E30000"><br></font></div><div style="text-align: -webkit-auto;"><font color="#E30000"><br></font></div><div style="text-align: -webkit-auto;"><font color="#1C3387"><b>13、内存索引库的特点：</b></font></div><div style="text-align: -webkit-auto;"><font color="#E30000">1、查询效率比较快</font></div><div style="text-align: -webkit-auto;"><font color="#E30000">2、数据不是持久化数据</font></div><div style="text-align: -webkit-auto;"><font color="#E30000">文件索引库的特点：</font></div><div style="text-align: -webkit-auto;"><font color="#E30000">1、查询效率比较慢</font></div><div style="text-align: -webkit-auto;"><font color="#E30000">2、数据是持久化的</font></div><div style="text-align: -webkit-auto;"><font color="#E30000">所以可以将内存索引库和文件索引库结合起来。</font></div><div style="text-align: -webkit-auto;"><font color="#E30000"><br></font></div><div style="text-align: -webkit-auto;"><font color="#E30000">cn.itheima.lucene.test.DirectoryTest.java </font></div><div style="text-align: -webkit-auto;"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">将数据存放如内存索引库，然后查询显示出来</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">DirectoryTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testRamDirectory()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">创建内存索引库</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Directory ramDirectory =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">RAMDirectory();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Article article =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Article();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            article.setId(1L);</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setTitle(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene可以用来做搜索引擎&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setContent(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;baidu、google搜索引擎公司&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexWriter indexWriter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexWriter(ramDirectory,LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,MaxFieldLength.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LIMITED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            Document document =</span> <span style="font-size:10pt; background:#d4d4d4">DocumentUtils</span><span style="font-size:10pt">.</span><span style="font-size:10pt"><i>article2Document</i></span><span style="font-size:10pt">(article);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.addDocument(document);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.close();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.showData(ramDirectory);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>private</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">showData(Directory directory)</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception{</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexSearcher indexSearcher =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexSearcher(directory);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            QueryParser queryParser =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">MultiFieldQueryParser(Version.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LUCENE_30</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String[]{</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">},LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query = queryParser.parse(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            TopDocs topDocs = indexSearcher.search(query,3);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            ScoreDoc[] scoreDocs = topDocs.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">scoreDocs</span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            List&lt;Article&gt; articles =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ArrayList&lt;Article&gt;();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(ScoreDoc scoreDoc : scoreDocs){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">index = scoreDoc.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">doc</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Document doc = indexSearcher.doc(index);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Article article =</span> <span style="font-size:10pt; background:#d4d4d4">DocumentUtils</span><span style="font-size:10pt">.</span><span style="font-size:10pt"><i>document2Article</i></span><span style="font-size:10pt">(doc);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  articles.add(article);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Article article : articles){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(article.getId() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getTitle() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getContent());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="lucene基础知识_files/Image [13].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><br></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">cn.itheima.lucene.test.DirectoryTest.java </span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">DirectoryTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">内存索引库和文件索引库合并的情况</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testFileAndRam()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">1、创建两个IndexWriter，一个对应文件索引库，一个对应内存索引库</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">2、把文件索引库复制到内存索引库</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">3、内存索引库与应用程序进行交互</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">4、将内存索引库同步到文件索引库</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Directory fileDirectory = FSDirectory.</span> <span style="font-size:10pt"><i>open</i></span><span style="font-size:10pt">(</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">File(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;./indexDir&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Directory ramDirectory =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">RAMDirectory(fileDirectory);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexWriter ramIndexWriter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexWriter(ramDirectory,LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,MaxFieldLength.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LIMITED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//如果下面的参数中不写true，那么就是追加索引，如果写了，就是清空，重新添加。</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexWriter fileIndexWriter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexWriter(fileDirectory,LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>true</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,MaxFieldLength.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>LIMITED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Article article =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Article();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            article.setId(2L);</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setTitle(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene可以用来做搜索引擎2&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setContent(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;baidu、google搜索引擎公司2&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            ramIndexWriter.addDocument(DocumentUtils.</span> <span style="font-size:10pt"><i>article2Document</i></span><span style="font-size:10pt">(article));</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            ramIndexWriter.close();</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//一定要在执行下面这条语句之前就要关闭ramIndexWriter，否则，数据就无法将新增的数据同步到文件IndexWriter中。</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            fileIndexWriter.addIndexesNoOptimize(ramDirectory);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            fileIndexWriter.close();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.showData(fileDirectory);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="lucene基础知识_files/Image [14].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">注：lucene提供了一些方法可以做很多个索引库出来（在一个项目中），可以针对某一个索引库进行检索，还可以针对合并的索引库进行检索。fileIndexWrriter.addIndexesNoOptimize(ramDirectory)。</span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;"><br></span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;"><br></span></div><div><span style="text-align: -webkit-auto;"><font color="#1C3387"><b>14、分词器</b></font></span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">针对不同的语言有不同的分词器。</span></div><div><img src="lucene基础知识_files/Image [15].png" type="image/png" height="343" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="386"/></div><div><br></div><div><font color="#E30000">cn.itheima.lucene.test.AnalyzerTest.java</font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">AnalyzerTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testAnalyzer_En()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception{</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Analyzer analyzer =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">StandardAnalyzer(Version.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LUCENE_30</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            String text =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;Creates a searcher&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.testAnalyzer(analyzer, text);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//下面的这段能够将分词期分离出来的词打印出来</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>private</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testAnalyzer(Analyzer analyzer,String text)</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            TokenStream tokenStream = analyzer.tokenStream(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">StringReader(text));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            tokenStream.addAttribute(TermAttribute.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>while</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(tokenStream.incrementToken()){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  TermAttribute termAttribute = tokenStream.getAttribute(TermAttribute.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(termAttribute.term());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">执行结果：</span></div><div><img src="lucene基础知识_files/Image [16].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><span style="color: rgb(227, 0, 0);">总结：英文分词器分词的三个步骤：</span></div><div><span style="color: rgb(227, 0, 0);">&lt;1&gt;切分关键词</span></div><div><span style="color: rgb(227, 0, 0);">&lt;2&gt;去掉听用此</span></div><div><span style="color: rgb(227, 0, 0);">&lt;3&gt;把大写变为小写</span></div><div><span style="color: rgb(227, 0, 0);"><br></span></div><div><span style="color: rgb(227, 0, 0);">单词法分词</span></div><div><span style="color: rgb(227, 0, 0);">cn.itheima.lucene.test.AnalyzerTest.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">AnalyzerTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testAnalyzer_CH1()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception{</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Analyzer analyzer =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ChineseAnalyzer();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span> <span style="font-size:10pt; background:#d4d4d4">String</span> <span style="font-size:10pt">text =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;黑马训练营&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.testAnalyzer(analyzer, text);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">执行结果：</span></div><div><img src="lucene基础知识_files/Image [17].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><br></div><div><span style="color: rgb(227, 0, 0);">二词法分词</span></div><div><span style="color: rgb(227, 0, 0);">cn.itheima.lucene.test.AnalyzerTest.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font><font face="Courier New" size="2"> </font><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">AnalyzerTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font><font face="Courier New" size="2"> </font><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">testAnalyzer_CH1() </span></font><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>throws</b></span></font><font face="Courier New" size="2"><span style="font-size: 10pt;"> Exception{</span></font></font></div><div align="left"><div align="left"><font color="#6A0081"><span style="text-align: -webkit-auto;">     </span><span style="text-align: -webkit-auto;">       </span><font face="Courier New" size="2" style="text-align: -webkit-auto;"><span style="font-size:10pt">Analyzer analyzer =</span></font> <font face="Courier New" size="2" style="text-align: -webkit-auto;"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2" style="text-align: -webkit-auto;"><span style="font-size:10pt">CJKAnalyzer(Version.</span></font><font face="Courier New" size="2" style="text-align: -webkit-auto;"><span style="font-size:10pt"><i>LUCENE_30</i></span></font><font face="Courier New" size="2" style="text-align: -webkit-auto;"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            String text =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;黑马训练营&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.testAnalyzer(analyzer, text);</span></font></font></div></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">执行结果：</span></div></div><div><img src="lucene基础知识_files/Image [18].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><br></div><div><span style="color: rgb(227, 0, 0);">IKAnalyzer的使用</span></div><div><span style="color: rgb(227, 0, 0);">&lt;1&gt;拷贝IKAnalyzer3.2.0Stable.jar。</span></div><div><font color="#E30000">&lt;2&gt;拷贝ext_stopword.dic(必须设置成UTF-8编码，否则无法使用)、IKAnalyzer.cfg.xml。</font></div><div><font color="#E30000">&lt;3&gt;使用IKAnalyzer进行分词解析。</font></div><div><font color="#E30000"><br></font></div><div><span style="color: rgb(227, 0, 0);">cn.itheima.lucene.test.AnalyzerTest.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font><font face="Courier New" size="2"> </font><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">AnalyzerTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font> <span style="font-size: 10pt; font-family: 'Courier New'; text-align: -webkit-auto;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testAnalyzer_CH3()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception{</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Analyzer analyzer =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IKAnalyzer();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            String</span> <span style="font-size:10pt; background:#d4d4d4">text</span> <span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;黑马训练营&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.testAnalyzer(analyzer,</span> <span style="font-size:10pt; background:#d4d4d4">text</span><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">执行结果：</span></div></div><div><img src="lucene基础知识_files/Image [19].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><span style="color: rgb(227, 0, 0);">注：之所以能够达到这样的效果，是因为IKAnalyzer的jar包中包含了很多的dic文件，里面设置了大量的中文词汇。</span></div><div><span style="color: rgb(227, 0, 0);"><br></span></div><div><font color="#E30000">IKAnalyzer还提供了扩展配置，使用户可以自己添加dic文件（包括扩展字典和扩展停止词字典，并且必须是UTF-8编码类型的，项目也必须是UTF-8编码的）。</font></div><div><font color="#E30000"> </font></div><div><font color="#E30000">IKAnalyzer.cfg.xml</font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;?</span></font><font face="Courier New" size="2"><span style="font-size:10pt">xml</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">version</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;1.0&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">encoding</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;UTF-8&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">?&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;!</span></font><font face="Courier New" size="2"><span style="font-size:10pt">DOCTYPE</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">properties</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">SYSTEM</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;http://java.sun.com/dtd/properties.dtd&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">properties</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"> </span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">entry</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">key</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;ext_dict&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">/mydict.dic</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">entry</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">entry</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">key</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;ext_stopwords&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">/ext_stopword.dic</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">entry</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">properties</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#008080" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">mydict.dic</span></div><div><span style="color: rgb(227, 0, 0);">方立勋</span></div><div><span style="color: rgb(227, 0, 0);"><br></span></div><div><span style="color: rgb(227, 0, 0);">执行结果：</span></div><div><img src="lucene基础知识_files/Image [20].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><br></div><div><font color="#E30000">ext_stopword.dic</font></div><div><font color="#E30000">方立勋</font></div><div><font color="#E30000"><br></font></div><div><font color="#E30000">执行结果：</font></div><div><img src="lucene基础知识_files/Image [21].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><br></div><div><br></div><div><font color="#1C3387"><b>15、高亮</b></font></div><div><font color="#E30000">高亮的作用是：1、使关键词高亮 2、控制摘要的大小</font></div><div><font color="#E30000">cn.itheima.lucene.test.HighlighterTest.java</font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">HighlighterTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@</span><span style="font-size:10pt; background:#d4d4d4">Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testHighlighter()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexSearcher indexSearcher =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexSearcher(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            QueryParser queryParser =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">MultiFieldQueryParser(Version.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LUCENE_30</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String[]{</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">},LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query = queryParser.parse(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">添加高亮器</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Scorer scorer =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">QueryScorer(query);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">规定要高亮的文本的前缀和后缀，只适合网页</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Formatter formatter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">SimpleHTMLFormatter(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;&lt;font color='red'&gt;&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;&lt;/font&gt;&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Highlighter highlighter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Highlighter(formatter,scorer);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">设置摘要的大小</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Fragmenter fragmenter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">SimpleFragmenter(20);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            highlighter.setTextFragmenter(fragmenter);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            TopDocs topDocs = indexSearcher.search(query,3);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            ScoreDoc[] scoreDocs = topDocs.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">scoreDocs</span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            List&lt;Article&gt; articles =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ArrayList&lt;Article&gt;();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(ScoreDoc scoreDoc : scoreDocs){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">index = scoreDoc.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">doc</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Document doc = indexSearcher.doc(index);</span></font></div><div align="left"><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">使用高亮器</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">LuceneUtils.analyzer</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">用分词器把高亮部分的词分出来</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">field</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">针对哪个字段进行高亮</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">documnent.get(&quot;title&quot;)</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">获取要高亮的字段</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  String fragment = highlighter.getBestFragment(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, doc.get(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  doc.getField(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">).setValue(fragment);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Article article = DocumentUtils.</span> <span style="font-size:10pt"><i>document2Article</i></span><span style="font-size:10pt">(doc);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  articles.add(article);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Article article : articles){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(article.getId() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getTitle() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getContent());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">执行结果：</span></div><div><img src="lucene基础知识_files/Image [22].png" type="image/png" height="104" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="373"/></div><div><br></div><div><span style="color: rgb(227, 0, 0);">cn.itheima.lucene.test.HighlighterTest.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">HighlighterTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testHighlighter</span> <span style="font-size:10pt">()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexSearcher indexSearcher =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexSearcher(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            QueryParser queryParser =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">MultiFieldQueryParser(Version.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LUCENE_30</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String[]{</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">},LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query = queryParser.parse(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">添加高亮器</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Scorer scorer =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">QueryScorer(query);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">规定要高亮的文本的前缀和后缀，只适合网页</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Formatter formatter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">SimpleHTMLFormatter(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;&lt;font color='red'&gt;&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;&lt;/font&gt;&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Highlighter highlighter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Highlighter(formatter,scorer);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">设置摘要的大小</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Fragmenter fragmenter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">SimpleFragmenter(20);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            highlighter.setTextFragmenter(fragmenter);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            TopDocs topDocs = indexSearcher.search(query,3);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            ScoreDoc[] scoreDocs = topDocs.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">scoreDocs</span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            List&lt;Article&gt; articles =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ArrayList&lt;Article&gt;();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(ScoreDoc scoreDoc : scoreDocs){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">index = scoreDoc.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">doc</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Document doc = indexSearcher.doc(index);</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">使用高亮器</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">LuceneUtils.analyzer</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">用分词器把高亮部分的词分出来</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">field</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">针对哪个字段进行高亮</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">documnent.get(&quot;title&quot;)</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">获取要高亮的字段</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  String fragment1 = highlighter.getBestFragment(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, doc.get(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  String fragment2 = highlighter.getBestFragment(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, doc.get(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//如果这里不设置，那么就可能出现设置的值为null的情况</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>if</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(fragment1 !=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>null</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                        doc.getField(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">).setValue(fragment1);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  }</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//if(fragment2 != null){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                        doc.getField(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">).setValue(fragment2);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//}</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Article article = DocumentUtils.</span> <span style="font-size:10pt"><i>document2Article</i></span><span style="font-size:10pt">(doc);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  articles.add(article);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Article article : articles){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(article.getId() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getTitle() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getContent());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">执行结果： </span></div><div><img src="lucene基础知识_files/Image [23].png" type="image/png" height="173" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="412"/></div><div><b><font color="#1C3387"><br></font></b></div><div><b><font color="#1C3387">16、分页</font></b></div></div></div><div><span style="color: rgb(227, 0, 0);">cn.itheima.lucene.test.DispageTest.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">DispageTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testDispage()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception{</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            testSearch(0, 25);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>private</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testSearch(</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">firstResult,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">maxResult)</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexSearcher indexSearcher =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexSearcher(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            QueryParser queryParser =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">MultiFieldQueryParser(Version.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LUCENE_30</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String[]{</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">},LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query = queryParser.parse(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            TopDocs topDocs = indexSearcher.search(query,25);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            ScoreDoc[] scoreDocs = topDocs.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">scoreDocs</span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            List&lt;Article&gt; articles =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ArrayList&lt;Article&gt;();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">i = firstResult; i &lt; (firstResult + maxResult); i++){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">index = scoreDocs[i].</span></font><font face="Courier New" size="2"><span style="font-size:10pt">doc</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Document doc = indexSearcher.doc(index);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Article article = DocumentUtils.</span> <span style="font-size:10pt"><i>document2Article</i></span><span style="font-size:10pt">(doc);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  articles.add(article);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Article article : articles){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(article.getId() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getTitle() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getContent());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">执行结果： </span></div></div><div align="left"><img src="lucene基础知识_files/Image [24].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div align="left"><br></div><div align="left"><div><span style="color: rgb(227, 0, 0);">cn.itheima.lucene.test.DispageTest.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">DispageTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testDispage</span> <span style="font-size:10pt">()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception{</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            testSearch(20, 30);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>private</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testSearch(</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">firstResult,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">maxResult)</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexSearcher indexSearcher =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexSearcher(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            QueryParser queryParser =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">MultiFieldQueryParser(Version.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LUCENE_30</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String[]{</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">},LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query = queryParser.parse(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            TopDocs topDocs = indexSearcher.search(query,25);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            ScoreDoc[] scoreDocs = topDocs.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">scoreDocs</span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            List&lt;Article&gt; articles =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ArrayList&lt;Article&gt;();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//为了防止越界，所有有必要取最小值</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">length = Math.</span><span style="font-size:10pt"><i>min</i></span><span style="font-size:10pt">(topDocs.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">totalHits</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, firstResult + maxResult);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">i = firstResult; i &lt; length; i++){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">index = scoreDocs[i].</span></font><font face="Courier New" size="2"><span style="font-size:10pt">doc</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Document doc = indexSearcher.doc(index);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Article article = DocumentUtils.</span> <span style="font-size:10pt"><i>document2Article</i></span><span style="font-size:10pt">(doc);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  articles.add(article);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Article article : articles){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(article.getId() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getTitle() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getContent());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div><span style="color: rgb(227, 0, 0);">执行结果：</span></div><div><img src="lucene基础知识_files/Image [25].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><br></div><div><font color="#1C3387"><b>17、搜索方式</b></font></div><div><font color="#E30000">cn.itheima.lucene.test.LuceneTest.java</font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt; background-color: rgb(232, 242, 254);"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#e8f2fe"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#e8f2fe">LuceneTest {</span></font></font></div><div align="left"><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testCreateIndexBatch()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexWriter indexWriter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexWriter(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,MaxFieldLength.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>LIMITED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">i = 1; i &lt;= 25; i++){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  Article article =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Article();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  article.setId(Long.</span> <span style="font-size:10pt"><i>parseLong</i></span><span style="font-size:10pt">(i +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  article.setTitle(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene可以用来做搜索引擎&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  article.setContent(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;baidu搜索引擎公司&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  indexWriter.addDocument(DocumentUtils.</span> <span style="font-size:10pt"><i>article2Document</i></span><span style="font-size:10pt">(article));</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.close();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">cn.itheima.lucene.utils.DocumentUtils.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">DocumentUtils {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>static</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Document article2Document(Article article){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Document</span> <span style="font-size:10pt; background:#d4d4d4">document</span> <span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Document();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//由于这里存储的是String类型，所以使用范围查询的时候并不能查询出来任何结果，应该使用lucene自己提供的类型转换器进行转换</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//Field field1 = new Field(&quot;id&quot;,article.getId().toString(),Store.YES,Index.NOT_ANALYZED);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Field field1 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Field(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;id&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,NumericUtils.</span><span style="font-size:10pt"><i>longToPrefixCoded</i></span><span style="font-size:10pt">(article.getId()).toString(),Store.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>YES</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,Index.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>NOT_ANALYZED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);        </span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Field field2 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Field(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,article.getTitle(),Store.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>YES</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,Index.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>ANALYZED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Field field3 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Field(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,article.getContent(),Store.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>YES</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,Index.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>ANALYZED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span> <span style="font-size:10pt; background:#d4d4d4">document</span><span style="font-size:10pt">.add(field1);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span> <span style="font-size:10pt; background:#d4d4d4">document</span><span style="font-size:10pt">.add(field2);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span> <span style="font-size:10pt; background:#d4d4d4">document</span><span style="font-size:10pt">.add(field3);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">document</span><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>static</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Article document2Article(Document document){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Article article =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Article();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setId(NumericUtils.</span> <span style="font-size:10pt"><i>prefixCodedToLong</i></span><span style="font-size:10pt">(document.get(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;id&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setTitle(document.get(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setContent(document.get(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">article;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">cn.itheima.lucene.test.QueryTest.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">QueryTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">查询方式</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">   </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">关键字查询</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">查询所有的文档</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">范围查询</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">通配符查询</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">重点</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">短语查询</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">boolean查询</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">重点</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testTermQuery()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//关键字查询就是把一个关键词封装在了一个对象中，根据该关键词进行查询</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//下面的参数大小写不能写错，因为这里没有分词器，不会转换为小写</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Term term =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Term(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">TermQuery(term);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            testSearch(query);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryAllDocs()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//查询所有的文档</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">MatchAllDocsQuery();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.testSearch(query);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryRange()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception{</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//范围查询</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query = NumericRangeQuery.</span> <span style="font-size:10pt"><i>newLongRange</i></span><span style="font-size:10pt">(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;id&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, 5L, 15L,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>true</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>true</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.testSearch(query);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryWildCard()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception{</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//通配符查询 *代表任意多个任意字符 ?代表任意一个字符</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Term term =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Term(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;l*?&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">WildcardQuery(term);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.testSearch(query);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryPharse()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//短语查询</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Term term =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Term(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Term term2 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Term(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;搜索&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//因为不是同一个字段的，所以会报错</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//Term term2 = new Term(&quot;content&quot;,&quot;baidu&quot;);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            PhraseQuery query =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">PhraseQuery();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//两个以上的短语查询，如果不设置位置参数，那么什么也查不出来</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            query.add(term,0);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            query.add(term2,7);</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//query.add(term2);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.testSearch(query);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">boolean查询</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Occur.MUST</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">必须满足该条件</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">and</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Occur.MUST_NOT</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">必须不能满足该条件</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Occur.SHOULD</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">可以有可以没有</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">or</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testBooleanQuery()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception{</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Term term =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Term(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;l*&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">WildcardQuery(term);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Term term2 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Term(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;baidu&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query2 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">WildcardQuery(term2);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            BooleanQuery booleanQuery =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">BooleanQuery();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//Occur.MUST 必须满足该条件</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//Occur.MUST_NOT 必须不能满足该条件</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            booleanQuery.add(query, Occur.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>MUST</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//执行下面的语句，不会执行出来任何结果</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//booleanQuery.add(query, Occur.MUST_NOT);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            booleanQuery.add(query, Occur.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>MUST</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.testSearch(booleanQuery);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>private</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testSearch(Query query)</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexSearcher indexSearcher =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexSearcher(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                        </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            TopDocs topDocs = indexSearcher.search(query,25);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            ScoreDoc[] scoreDocs = topDocs.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">scoreDocs</span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            List&lt;Article&gt; articles =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ArrayList&lt;Article&gt;();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(ScoreDoc scoreDoc : scoreDocs){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">index = scoreDoc.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">doc</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Document doc = indexSearcher.doc(index);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Article article = DocumentUtils.</span> <span style="font-size:10pt"><i>document2Article</i></span><span style="font-size:10pt">(doc);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  articles.add(article);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Article article : articles){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(article.getId() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getTitle() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getContent());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><b style="color: rgb(28, 51, 135);">18、score</b></div><div><span style="color: rgb(227, 0, 0);">cn.itheima.lucene.test.LuceneTest.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">LuceneTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testCreateIndex()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Article article =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Article();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            article.setId(26L);</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setTitle(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene可以用来做搜索引擎&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            article.setContent(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;baidu、google搜索引擎公司&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexWriter indexWriter =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexWriter(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">,MaxFieldLength.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>LIMITED</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            Document document = DocumentUtils.</span> <span style="font-size:10pt"><i>article2Document</i></span><span style="font-size:10pt">(article);</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">//通过下面这种方式可以提高score值，应用场景为竞价排名</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            document.setBoost(100);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.addDocument(document);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            indexWriter.close();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div><span style="color: rgb(227, 0, 0);"><br></span></div><div><span style="color: rgb(227, 0, 0);">cn.itheima.lucene.test.ScoreTest.java</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">1、相同的关键词，相同的结构</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">         </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">得分一样</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">2、相同的结构，不同的关键词</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">         </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">得分不一样(lucene和搜索的得分是不一样的，一般情况下，中文比英文的得分高)</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">3、不同的结构，相同的关键词</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">         </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">关键词出现的次数越多，得分越高</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">4、竞价</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ScoreTest {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testSearch()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            IndexSearcher indexSearcher =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IndexSearcher(LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>directory</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            QueryParser queryParser =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">MultiFieldQueryParser(Version.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>LUCENE_30</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String[]{</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;title&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;content&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">},LuceneUtils.</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>analyzer</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Query query = queryParser.parse(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;lucene&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            TopDocs topDocs = indexSearcher.search(query,25);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            ScoreDoc[] scoreDocs = topDocs.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">scoreDocs</span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            List&lt;</span> <span style="font-size:10pt; background:#d4d4d4">Article</span><span style="font-size:10pt">&gt; articles =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ArrayList&lt;</span> <span style="font-size:10pt; background:#d4d4d4">Article</span><span style="font-size:10pt">&gt;();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(ScoreDoc scoreDoc : scoreDocs){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(scoreDoc.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">score</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">index = scoreDoc.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">doc</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  Document doc = indexSearcher.doc(index);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span> <span style="font-size:10pt; background:#d4d4d4">Article</span> <span style="font-size:10pt">article = DocumentUtils.</span><span style="font-size:10pt"><i>document2Article</i></span><span style="font-size:10pt">(doc);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">                  articles.add(article);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(</span><span style="font-size:10pt; background:#d4d4d4">Article</span> <span style="font-size:10pt">article : articles){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(article.getId() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getTitle() +</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;\n&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ article.getContent());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div></body></html> 