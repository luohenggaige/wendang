<html>
<head>
  <title>Evernote Export</title>
  <basefont face="楷体" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/268868 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: 楷体;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="654"/>
<h1>01 JBPM基础知识</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><font color="#E30000">1、黑马程序员入学共5个环节：提交自荐信—&gt;提</font><span style="color: rgb(227, 0, 0);">交</span><font color="#E30000">基础</font><font color="#E30000">测试—&gt;申请入学考试—&gt;提交入学考试题—&gt;面试。。</font><div><font color="#E30000"><br></font></div><div><font color="#E30000">2、工作流：</font></div><div><font color="#E30000">①指定流程：在指定流程的过程中，会经历很多版本。</font></div><div><font color="#E30000">②流程正式启动</font></div><div><font color="#E30000">③启动流程实例</font></div><div><font color="#E30000">④申请</font></div><div><font color="#E30000">⑤审批</font></div><div><font color="#E30000">⑥流程结束</font></div><div><font color="#E30000">注：虽然利用数据库也可以控制业务流程，但是设计的表通用性不强，根据业务可能需要经常性的进行变更。</font></div><div><font color="#E30000"><br></font></div><div><font color="#E30000">3、注：activiti是jbpm4的升级版本，jbpm5是jboss推出的一个与jbpm4相差很大的版本。</font></div><div><font color="#E30000">jbpm4使用流程：</font></div><div><font color="#E30000">①画流程图：用eclipse提供的插件</font></div><div><font color="#E30000">②把流程图部署到jbpm引擎中</font></div><div><font color="#E30000">③启动流程实例</font></div><div><font color="#E30000">④发起申请</font></div><div><font color="#E30000">⑤审批</font></div><div><font color="#E30000">注：如果没有轮到李四审批，李四是看不到任务的。</font></div><div><font color="#E30000">    在申请和审批的过程中会产生一些数据。</font></div><div><font color="#E30000">    安装jbpm 4 Process Definition只要能在src右击New能看到jBPM 4 Process Definition就说明安装成功了。</font></div><div><font color="#E30000"><br></font></div><div><font color="#E30000">4、画流程图的流程</font></div><div><font color="#E30000">创建一个应用程序——&gt;画流程图获得*.jpdl.xml，*.png，这两个文件一起称为流程定义文档——&gt;部署到jbpm引擎中（①通过部署，把流程定义文档放入到了数据库中②启动流程实例③申请④审批）——&gt;通过hibernate技术部署到DB上。</font></div><div><font color="#E30000">注：学习JBPM重点在于：①流程定义文档XML②JBPM API③数据库的结构（重点）</font></div><div><font color="#E30000"><br></font></div><div><font color="#E30000">5、画流程图</font></div><div><font color="#E30000"><img src="JBPM_files/Image.png" type="image/png" height="472" style="cursor: default;cursor: default;cursor: default;cursor: default;" width="717"/></font></div><div><font color="#E30000"><img src="JBPM_files/Image [1].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;"/></font></div><div><font color="#E30000"><img src="JBPM_files/Image [2].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;"/></font></div><div><img src="JBPM_files/Image [3].png" type="image/png" height="578" style="cursor: default;cursor: default;cursor: default;" width="737"/></div><div><img src="JBPM_files/Image [4].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div><img src="JBPM_files/Image [5].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div><font color="#E30000"><br></font></div><div><br></div></div>
</div>
<hr>
<a name="716"/>
<h1>02 使用JBPM</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><font color="#E30000">1、导入Jar包<br></font><div><font color="#E30000">导入jbpm.jar包核心包以及其他lib包（注：某些包不需要导入）。</font></div><div><font color="#E30000"><br></font></div><div><font color="#E30000">2、将定义文档以及hibernate链接文件以及映射文件放在src目录下。</font></div><div><img src="JBPM_files/Image [6].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><font color="#E30000"><br></font></div><div><font color="#E30000">注：jbpm.hibernate.cfg.xml中涉及的映射文件都可以在jbpm.jar中找到。</font></div><div><br></div><div><img src="JBPM_files/Image [7].png" type="image/png" height="249" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="883"/></div><div><br></div><div><font color="#E30000">3、修改jbpm.hibernate.cfg.xml</font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;?</span></font><font face="Courier New" size="2"><span style="font-size:10pt">xml</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">version</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;1.0&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">encoding</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;utf-8&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">?&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;!</span></font><font face="Courier New" size="2"><span style="font-size:10pt">DOCTYPE</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">hibernate-configuration</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">PUBLIC</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">         </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">         </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">hibernate-configuration</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">session-factory</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"> </span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><font color="#6A0081">   </font><font color="#328712"> </font></span></font> <font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">property</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;hibernate.dialect&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">org.hibernate.dialect.MySQLInnoDBDialect</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">property</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">    </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">property</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;hibernate.connection.driver_class&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">com.mysql.jdbc.Driver</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">property</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">    </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">property</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;hibernate.connection.url&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">jdbc:mysql://localhost:3306/jbpm</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">property</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">    </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">property</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;myeclipse.connecion.profile&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">mysql</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">property</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">    </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">property</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;hibernate.connection.username&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">root</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">property</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">    </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">property</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;hibernate.connection.password&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">sorry</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">property</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">    </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">property</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;hibernate.hbm2ddl.auto&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">update</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">property</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">    </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">property</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;hibernate.show_sql&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">true</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">property</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">    </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">property</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;current_session_context_class&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">thread</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">property</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">    </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">    </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">mapping</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">resource</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;jbpm.repository.hbm.xml&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">    </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">mapping</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">resource</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;jbpm.execution.hbm.xml&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">    </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">mapping</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">resource</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;jbpm.history.hbm.xml&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">    </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">mapping</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">resource</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;jbpm.task.hbm.xml&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">    </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">mapping</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">resource</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;jbpm.identity.hbm.xml&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">    </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">session-factory</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">hibernate-configuration</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#008080" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">4、创建18张表</span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">cn.itheima.jbpm.test.CreateTable.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">CreateTable {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testTable</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Configuration configuration =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Configuration();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            configuration.configure(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;jbpm.hibernate.cfg.xml&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            configuration.buildSessionFactory();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">5、将定义文档部署到数据库中。</span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">cn.itheima.jbpm.test.BaseJbpm.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">BaseJbpm {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>static</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ProcessEngine</span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>static</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">{</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4"><i>processEngine</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">= Configuration.</span><span style="font-size:10pt"><i>getProcessEngine</i></span> <span style="font-size:10pt">();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">cn.itheima.jpbm.test.PDManagerTest.java</span></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">PDManagerTest</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>extends</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">BaseJbpm{</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">/**</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">流程定义管理</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">1、部署流程定义文档</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">2、查看流程图</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">3、查询</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">   </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">部署的查询</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">   </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">流程定义的查询</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">4、删除</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testDeploy(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            .createDeployment()</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            .addResourceFromClasspath(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.jpdl.xml&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            .addResourceFromClasspath(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.png&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            .deploy();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">6、执行效果</span></div><div><img src="JBPM_files/Image [8].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;"/></div></div></div></div>
</div>
<hr>
<a name="1869"/>
<h1>03 JBPM部署和流程定义的表结构分析</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><font color="#E30000">1、涉及到的表</font><div><font color="#E30000">&lt;1&gt;JBPM4_DEPLOYMENT</font></div><div><font color="#E30000">部署表：用来描述一次部署的</font></div><div><font color="#E30000">每部署一次，该表中增加一行记录</font></div><div><font color="#E30000">DBID_:主键 部署ID</font></div><div><img src="JBPM_files/Image [9].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div><font color="#E30000">&lt;2&gt;JPBM4_LOB</font></div><div><font color="#E30000">数据仓库表：xml文件和png图片都存在这里</font></div><div><font color="#E30000">BLOB_VALUE:存放数据</font></div><div><font color="#E30000">DEPLOYMENT_:部署ID 可以通过部署ID查找到JBPM4_LOB表中的内容</font></div><div><font color="#E30000">NAME_:文件的路径和名称</font></div><div><img src="JBPM_files/Image [10].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div><span style="color: rgb(227, 0, 0);">&lt;3&gt;JBPM4_PROPERTY</span></div><div><img src="JBPM_files/Image [11].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div><font color="#E30000">&lt;4&gt;JBPM4_DEPLOYPROP</font></div><div><font color="#E30000">部署属性表</font></div><div><font color="#E30000">KEY:_</font></div><div><font color="#E30000">     langid 流程定义语言的版本</font></div><div><font color="#E30000">     pdkey 流程定义的名称，等同于pdname      </font></div><div><font color="#E30000">     pdversion 流程定义版本</font></div><div><font color="#E30000">          如果pdkey不变，每部署一次，版本号加1</font></div><div><font color="#E30000">          如果pdkey发生改变，则版本号从1开始计算</font></div><div><font color="#E30000">     pdid      {pdkey}--{pdversion}</font></div><div><font color="#E30000">          不管部署几次，pdid是唯一的</font></div><div><span style="color: rgb(227, 0, 0);">deploymentID和pdid：一个deploymentID对应一个pdid。</span></div><div><span style="color: rgb(227, 0, 0);">把握以下几个字段就可以确定一个流程定义：pdid，langid，pdkey，pdversion</span></div><div><font color="#E30000"><br></font></div><div><img src="JBPM_files/Image [12].png" type="image/png" height="253" style="cursor: default;cursor: default;cursor: default;" width="623"/></div><div><img src="JBPM_files/Image [13].png" type="image/png" style="cursor: default;cursor: default;"/></div><div><br></div><div><font color="#E30000">注：</font></div><div><font color="#E30000">bpm:business process management</font></div><div><font color="#E30000">jbpm:jboss business process management</font></div><div><font color="#E30000">pdl:process definition language</font></div><div><font color="#E30000">jpdl:jboss process definition language</font></div><div><br></div></div>
</div>
<hr>
<a name="1069"/>
<h1>04 JBPM的三种部署方式</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left"><font color="#E30000">cn.itheima.jbpm.test.PDManagerTest.java</font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">PDManagerTest</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>extends</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">BaseJbpm{</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testDeployFromClassPath(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            .createDeployment()</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            .addResourceFromClasspath(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.jpdl.xml&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            .addResourceFromClasspath(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.png&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            .deploy();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testDeployFromInputStream(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            InputStream xmlInputStream =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getClass().getClassLoader().getResourceAsStream(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.jpdl.xml&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            InputStream pngInputStream =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getClass().getClassLoader().getResourceAsStream(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.png&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            .createDeployment()</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            .addResourceFromInputStream(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.jpdl.xml&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, xmlInputStream)</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            .addResourceFromInputStream(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.png&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, pngInputStream)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            .deploy();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testDeployFromZipInputStream</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            ZipInputStream zipInputStream =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ZipInputStream(</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">.getClass().getClassLoader().getResourceAsStream(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.zip&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">));</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            .createDeployment()</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            .addResourcesFromZipInputStream(zipInputStream)</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            .deploy();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div></div>
</div>
<hr>
<a name="1020"/>
<h1>05 JBPM的部署和流程定义的相关操作</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><font color="#E30000">1、部署的查询</font><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">部署的查询</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryDeployment(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;Deployment&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .createDeploymentQuery()</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Deployment deployment : list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(deployment.getId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(deployment.getState());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div></div><div align="left"><img src="JBPM_files/Image [14].png" type="image/png" style="cursor: default;cursor: default;"/></div><div align="left"><br></div><div align="left"><div><span style="text-align: -webkit-auto;"><font color="#E30000">2、根据deploymentId查询部署</font></span></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">根据deploymentId查询部署</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryDeploymentById(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      Deployment deployment =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .createDeploymentQuery()</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .deploymentId(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;40001&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .uniqueResult();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(deployment.getId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(deployment.getState());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div></div><div align="left"><div><span style="text-align: -webkit-auto;"><br></span></div><div><span style="text-align: -webkit-auto;"><font color="#E30000">执行结果：</font></span></div></div><div align="left"><img src="JBPM_files/Image [15].png" type="image/png" style="cursor: default;cursor: default;"/></div><div align="left"><br></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">3、查询所有的流程定义</span></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">查询所有的流程定义</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryAllPD(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;ProcessDefinition&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .createProcessDefinitionQuery()</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(ProcessDefinition pd : list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;deploymentId:&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ pd.getDeploymentId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;pdKey:&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ pd.getKey());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;pkVersion:&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ pd.getVersion());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;pdid:&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ pd.getId());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">4、根据deploymentID查询流程定义</span></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">根据deploymentID查询流程定义</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryPDByDeploymentId(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      ProcessDefinition pd =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .createProcessDefinitionQuery()</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .deploymentId(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;40001&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .uniqueResult();</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;deploymentId:&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ pd.getDeploymentId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;pdKey:&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ pd.getKey());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;pkVersion:&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ pd.getVersion());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;pdid:&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">+ pd.getId());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">注：还可以根据pdid、pdkey来对流程定义进行查询。</span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="JBPM_files/Image [16].png" type="image/png" style="cursor: default;cursor: default;"/></div><div><br></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">5、把某一个流程定义文件保存在某一个位置</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">把某一个流程保存在某一个位置</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>@throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IOException</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testSavePng()</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IOException{</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      InputStream inputStream =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .getResourceAsStream(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;40001&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.png&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      OutputStream outputStream =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">FileOutputStream(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;E:\\qingjia.png&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">b = -1; (b = inputStream.read())!=-1;){</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            outputStream.write(b);</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      inputStream.close();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      outputStream.close();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;"><br></span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div></div><div align="left"><img src="JBPM_files/Image [17].png" type="image/png" style="cursor: default;cursor: default;"/></div><div align="left"><br></div><div align="left"><br></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">6、删除流程实例</span></div></div><div align="left"><img src="JBPM_files/Image [18].png" type="image/png" style="cursor: default;cursor: default;"/></div><div align="left"><br></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">删除</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">根据API只能删除一个流程定义下的一个版本</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testDeletePD() {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .deleteDeploymentCascade(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;120015&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font color="#010101" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">删除一个流程定义的所有版本</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">只根据提供deploymentID进行删除，不是特别好，应该提供一个API，根据pdKey删除</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testDeletePD2</span> <span style="font-size:10pt">() {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;ProcessDefinition&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .createProcessDefinitionQuery()</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .processDefinitionKey(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia1&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(ProcessDefinition pd:list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">            .deleteDeploymentCascade(pd.getDeploymentId());</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div></div></div></div></div></div></div></div>
</div>
<hr>
<a name="1291"/>
<h1>06 JBPM的流程实例和任务的相关操作</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><font color="#E30000">1、启动一个流程实例</font><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testStartPIBYPID(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getExecutionService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .startProcessInstanceById(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia-1&quot; </span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="JBPM_files/Image [19].png" type="image/png" height="67" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="942"/></div><div><br></div><div><font color="#E30000">2、</font></div><div><img src="JBPM_files/Image [20].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><font color="#E30000">由上图可以看出，ProcessInstance其实与Execution是一致的。</font></div><div><img src="JBPM_files/Image [21].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><font color="#E30000">由上图可以看出，ProcessInstance中在有分支并行运行的时候包含多个execution。</font></div><div><font color="#E30000"><br></font></div><div><font color="#E30000">3、使用pdKey启动一个流程实例</font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">如果是根据pdKey启动流程实例，启动的是最高版本的</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testStartPI(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getExecutionService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .startProcessInstanceByKey(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">4、完成某个任务</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testFinishTask</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .completeTask(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;130002&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div></div><div align="left"><img src="JBPM_files/Image [22].png" type="image/png" height="86" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="953"/></div><div align="left"><font color="#E30000">注：如果jbpm.hibernate.cfg.xml中没有设置<font face="Courier New" size="2"><span style="font-size:10pt; background:#e8f2fe">&lt;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#e8f2fe">property</span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#e8f2fe">name</span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#e8f2fe">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt; background:#e8f2fe">&quot;hibernate.dialect&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt; background:#e8f2fe">&gt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt; background:#e8f2fe">org.hibernate.dialect.MySQLInnoDBDialect</span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#e8f2fe">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt; background:#e8f2fe">property</span></font><font face="Courier New" size="2"><span style="font-size:10pt; background:#e8f2fe">&gt;</span></font>中的引擎为MySQLInnoDBDialect，那么就可能会出现外键问题从而导致任务不能正常完成。</font></div><div align="left"><font color="#E30000"><br></font></div><div align="left"><font color="#E30000">5、查询出所有的task</font></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">查询出所有的task</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryAllTask(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;Task&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .createTaskQuery()</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Task task : list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getAssignee());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getExecutionId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getName());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getCreateTime());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">6、根据任务的执行人查看任务</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">根据任务的执行人查看任务</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@</span><span style="font-size:10pt; background:#d4d4d4">Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryTaskByAssignee(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;Task&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .createTaskQuery()</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .assignee(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;张三&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Task task : list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getAssignee());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getExecutionId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getName());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getCreateTime());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div></div><div align="left"><img src="JBPM_files/Image [23].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div align="left"><br></div><div align="left"><font color="#E30000">7、根据节点名称查看正在执行的任务</font></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">根据节点名称查看正在执行的任务</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testQueryTaskByActivityName</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;Task&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .createTaskQuery()</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .activityName(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;请假申请&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Task task : list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getAssignee());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getExecutionId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getName());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getCreateTime());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">8、根据executionID查看正在执行的任务</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">根据executionID查看正在执行的任务</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testQueryTaskByExecutionId</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;Task&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .createTaskQuery()</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .executionId(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.10001&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Task task : list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getAssignee());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getExecutionId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getName());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getCreateTime());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#E30000">9、根据pdid可以查询很多个任务</font></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">根据pdid可以查询很多个任务</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testQueryTaskByPdid</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;Task&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .createTaskQuery()</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .processDefinitionId(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia-1&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Task task : list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getAssignee());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getExecutionId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getName());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getCreateTime());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">10、根据piid可以查询很多个任务</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testQueryTaskByPiid</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;Task&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .createTaskQuery()</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .processInstanceId(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.10001&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Task task : list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getAssignee());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getExecutionId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getName());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getCreateTime());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">11、根据任务ID查看任务</span></div></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testQueryTaskByTaskId</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      Task task2 =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService().getTask(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;10002&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task2.getAssignee());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task2.getId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task2.getExecutionId());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task2.getName());</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task2.getCreateTime());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">12、查看已经完成的任务</span></div></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">查看已经完成的任务</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testQueryHistTask</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;HistoryTask&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getHistoryService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .createHistoryTaskQuery().state(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;completed&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(HistoryTask historyTask : list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(historyTask.getEndTime());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">13、根据taskId查询已经完成的任务</span></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryHistTask(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;HistoryTask&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getHistoryService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .createHistoryTaskQuery().state(&quot;completed&quot;).taskId(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;10002&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(HistoryTask historyTask : list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.</span><span style="font-size:10pt; background:#d4d4d4">println</span><span style="font-size:10pt">(historyTask.getEndTime());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div><span style="color: rgb(227, 0, 0);">14、根据任务的执行人查询已经完成的任务</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryHistTask(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;HistoryTask&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getHistoryService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .createHistoryTaskQuery().assignee(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;张三&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(HistoryTask historyTask : list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(historyTask.getEndTime());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div><span style="color: rgb(227, 0, 0);">15、根据指定时间之前查询已经完成的任务</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryHistTask(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;HistoryTask&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getHistoryService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .createHistoryTaskQuery().startedBefore(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Date())</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(HistoryTask historyTask : list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(historyTask.getEndTime());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div><span style="color: rgb(227, 0, 0);">16、根据executionId查询已经完成的任务</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryHistTask(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;HistoryTask&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getHistoryService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .createHistoryTaskQuery().state(&quot;completed&quot;).executionId(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.10001&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(HistoryTask historyTask : list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(historyTask.getEndTime());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">17、查询所有的正在执行的流程实例</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">查询所有正在执行的流程实例</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testQueryHistTask(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      List&lt;ProcessInstance&gt; list =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getExecutionService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .createProcessInstanceQuery()</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .list();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(ProcessInstance</span> <span style="font-size:10pt; background:#d4d4d4">pi</span> <span style="font-size:10pt">: list){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(</span><span style="font-size:10pt; background:#d4d4d4">pi</span><span style="font-size:10pt">.getProcessDefinitionId());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">18、直接结束流程实例</span></div></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">直接结束流程实例</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testEndPI(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getExecutionService().endProcessInstance(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.10001&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;failed&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div></div><div align="left"><img src="JBPM_files/Image [24].png" type="image/png" height="57" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="1062"/></div><div align="left"><br></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<hr>
<a name="821"/>
<h1>07 JBPM的流程实例和任务的表结构分析</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><font color="#E30000">涉及到的表：</font><div><font color="#E30000">&lt;1&gt;JBPM4_EXECUTION</font></div><div><font color="#E30000">     表示正在执行的流程实例</font></div><div><font color="#E30000">     是一个临时表，当流程实例执行完毕以后，就会从该表中删除。</font></div><div><font color="#E30000">DBID_:主键 executionId</font></div><div><font color="#E30000">activityname_:表示流程实例正在执行的节点</font></div><div><font color="#E30000">procdefid_:流程定义ID pdid</font></div><div><font color="#E30000">id_:流程实例ID pidd</font></div><div><img src="JBPM_files/Image [25].png" type="image/png" height="72" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="944"/></div><div><font color="#E30000">&lt;2&gt;JBPM4_HIST_PROCINST（process instance）</font></div><div><font color="#E30000">     表示历史的流程实例<br></font></div><div><font color="#E30000">     当前正在执行的流程实例也在这张表中，只不过结束时间为null，状态为active</font></div><div><font color="#E30000">     当流程实例结束以后，结束时间不为null，状态为ended</font></div><div><img src="JBPM_files/Image [26].png" type="image/png" height="45" style="cursor: default;cursor: default;cursor: default;" width="1053"/></div><div><font color="#E30000">&lt;3&gt;JBPM4_TASK</font></div><div><font color="#E30000">     正在执行的任务</font></div><div><font color="#E30000">     DBID_:主键、任务ID</font></div><div><font color="#E30000">     NAME_:任务的名称</font></div><div><font color="#E30000">     ASSIGNEE_:任务的执行人</font></div><div><font color="#E30000">     是一个临时表，存放正在执行的任务，如果该任务已经执行完成，则会从这张表中删除。</font></div><div><img src="JBPM_files/Image [27].png" type="image/png" height="46" style="cursor: default;cursor: default;cursor: default;" width="1024"/></div><div><font color="#E30000">&lt;4&gt;JBPM4_HIST_TASK</font></div><div><font color="#E30000">     历史任务</font></div><div><font color="#E30000">     当前正在执行的任务也在这张表中，结束时间为null，状态为null</font></div><div><font color="#E30000">     当一个任务完成以后，状态就改为completed</font></div><div><img src="JBPM_files/Image [28].png" type="image/png" height="48" style="cursor: default;cursor: default;cursor: default;" width="1028"/></div><div><font color="#E30000">&lt;5&gt;JBPM4_HIST_ACTINST</font></div><div><font color="#E30000">     历史节点</font></div><div><font color="#E30000">     task只是节点的一种常用的类型</font></div><div><img src="JBPM_files/Image [29].png" type="image/png" height="49" style="cursor: default;cursor: default;cursor: default;" width="986"/></div></div>
</div>
<hr>
<a name="2002"/>
<h1>08 流程变量</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><font color="#E30000">流程变量</font><div><font color="#E30000">1、流程变量的生命周期</font></div><div><font color="#E30000">     流程实例启动到流程实例结束</font></div><div><font color="#E30000">2、流程变量依赖的条件</font></div><div><font color="#E30000">     流程变量依赖于流程实例</font></div><div><font color="#E30000">3、怎么样把流程变量存放到流程实例中</font></div><div><font color="#E30000">     启动流程实例</font></div><div><font color="#E30000">     在任务节点 </font></div><div><font color="#E30000">     在整个流程实例范围内</font></div><div><font color="#E30000">4、怎么样从流程实例中把流程变量取出</font></div><div><font color="#E30000">     在任务节点</font></div><div><font color="#E30000">     在整个流程实例范围内</font></div><div><font color="#E30000">5、流程变量的类型</font></div><div><font color="#E30000">说明：在整个流程实例结束以后，流程变量被删除掉了。</font></div><div><font color="#E30000"><br></font></div><div><font color="#E30000">涉及到的临时表：JBPM4_VARIABLE</font></div><div><font color="#E30000"><br></font></div><div><font color="#E30000">1、在流程实例启动的时候存放流程变量</font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">VariablesTest</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>extends</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">BaseJbpm {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testStart</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            Map&lt;String,String&gt; variables =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">HashMap&lt;String,String&gt;();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            variables.put(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;启动流程实例&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;在启动流程实例的时候，设置流程变量&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getExecutionService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            .startProcessInstanceById(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia-1&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,variables);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div></div><div><img src="JBPM_files/Image [30].png" type="image/png" height="53" style="cursor: default;cursor: default;" width="1037"/></div><div><br></div><div><span style="color: rgb(227, 0, 0);">2、完成任务的时候，设置流程变量</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testFinishTask</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      Map&lt;String,String&gt; variables =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">HashMap&lt;String,String&gt;();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      variables.put(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;完成任务&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;在完成任务的时候设置流程变量&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .completeTask(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;20003&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,variables);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="JBPM_files/Image [31].png" type="image/png" height="141" style="cursor: default;cursor: default;" width="1005"/></div><div><font color="#E30000">注：在任务执行结束的时候不能存放流程变量。</font></div><div><br></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">3、在任务的任何环节，设置流程变量</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testFinishTask</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      Map&lt;String,String&gt; variables =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">HashMap&lt;String,String&gt;();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      variables.put(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;完成任务&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;在完成任务的时候设置流程变量&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService().setVariables(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;20003&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">, variables);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="JBPM_files/Image [32].png" type="image/png" style="cursor: default;cursor: default;"/></div><div><br></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">4、在整个流程实例的范围内设置流程变量</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testFinishTask</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getExecutionService().setVariable(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.20001&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;在流程实例范围内&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;在流程实例范围内设置流程变量&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="JBPM_files/Image [33].png" type="image/png" style="cursor: default;cursor: default;"/></div><div><br></div><div><font color="#E30000">5、在任务节点时，获取流程变量</font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">在任务节点时，获取流程变量</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testGetVariablesWhenTask</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      String str =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .getVariable(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;20003&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;启动流程实例&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">).toString();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(str);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">6、在整个流程实例范围内获取流程变量</span></div></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testGetVariablesWhenPI(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      String str =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getExecutionService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .getVariable(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.20001&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;在流程实例范围内&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">).toString();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(str);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">7、永久性的存储流程变量：jbpm4_hist_var表中存放历史的流程变量。</span></div><div><span style="color: rgb(227, 0, 0);">jbpm4_hist_var表中可以存放数据，但是数据结构是固定的，满足不了各种查询，所以在系统中流程的控制表和数据表是分开的。</span></div></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testSaveVariables</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getExecutionService().createVariable(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.20001&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;aaa&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;aaaass&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>true</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="JBPM_files/Image [34].png" type="image/png" style="cursor: default;cursor: default;"/></div><div><br></div><div><font color="#E30000">8、实际项目中将流程的控制表和程序员自己建的表分开，也就是将控制和数据分开</font></div><div><img src="JBPM_files/Image [35].png" type="image/png" height="402" style="cursor: default;cursor: default;" width="1106"/></div><div><br></div><div><font color="#E30000">9、流程变量的实例</font></div><div><font color="#E30000">JBPM中的流程变量类型必须是符合实现了Serializable接口的类的类型，例如Date、String等，Integer不支持，因为它没有实现序列化。</font></div><div align="left"><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Person implements Serializable{</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>private</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Long</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">pid</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>private</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Long getPid() {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">pid</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">setPid(Long pid) {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">pid</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">= pid;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String getName() {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>return</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">setName(String name) {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>this</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">name</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">= name;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div></div><div align="left"><font color="#646464" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testStart(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      Map&lt;String,Object&gt; variables =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">HashMap&lt;String,Object&gt;();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      Person person =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Person();</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      person.setPid(1L);</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      person.setName(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;aaa&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      variables.put(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;person&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, person);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getExecutionService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .startProcessInstanceById(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia-1&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,variables);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testGetVariablesWhenPI(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span><span style="font-size:10pt; background:#d4d4d4">Person</span> <span style="font-size:10pt">person = (</span><span style="font-size:10pt; background:#d4d4d4">Person</span><span style="font-size:10pt">)</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getExecutionService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .getVariable(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;qingjia.20001&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;person&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(person.getName());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">注：同一个流程定义创建出的两个流程实例的两个流程变量是相互独立，没有任何关系的。</span></div></div></div></div></div></div></div></div></div></div>
</div>
<hr>
<a name="700"/>
<h1>09 流程定义语言</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><font color="#E30000">Transition(连线)</font><div><font color="#E30000">节点与节点之间的连线，也可以认为是节点与节点之间的通话。</font></div><div><font color="#E30000">说明：</font></div><div><font color="#E30000">1)开始节点只能有一个</font><span style="color: rgb(227, 0, 0);">Transition</span><span style="color: rgb(227, 0, 0);">。</span></div><div><font color="#E30000">2)结束节点没有</font><span style="color: rgb(227, 0, 0);">Transition</span><span style="color: rgb(227, 0, 0);">。</span></div><div><br></div><div><img src="JBPM_files/Image [36].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div><img src="JBPM_files/Image [37].png" type="image/png" style="cursor: default;cursor: default;cursor: default;"/></div><div><font color="#E30000">1、直接完成任务到to end1节点。</font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testFinishTask</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      String outcome =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;to end1&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .completeTask(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;20001&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,outcome);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div></div>
</div>
<hr>
<a name="1944"/>
<h1>10 State</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><font color="#E30000">1、State与Task不同，Task需要有人参与，State不需要有人参与。</font><div><img src="JBPM_files/Image [38].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><img src="JBPM_files/Image [39].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testDeployFromClassPath(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .createDeployment()</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .addResourceFromClasspath(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;state.jpdl.xml&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .addResourceFromClasspath(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;state.png&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      .deploy();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testStart(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getExecutionService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .startProcessInstanceById(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;state-1&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div></div></div><div><img src="JBPM_files/Image [40].png" type="image/png" height="160" style="cursor: default;cursor: default;cursor: default;cursor: default;" width="1271"/></div><div><img src="JBPM_files/Image [41].png" type="image/png" height="133" style="cursor: default;cursor: default;cursor: default;cursor: default;" width="1111"/></div><div><br></div><div><img src="JBPM_files/Image [42].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><font color="#E30000">注：流程执行的过程中会有一个token，这个token指示到执行的地方。</font></div><div><font color="#E30000"><br></font></div><div><font color="#E30000">2、继续执行state。</font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testFinishedState(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getExecutionService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .signalExecutionById(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;state.10001&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">3、跳转到指定的状态</span></div></div><div align="left"><img src="JBPM_files/Image [43].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div align="left"><img src="JBPM_files/Image [44].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div align="left"><font color="#E30000">上面的第三个方法的第二个参数与completeTask方法中的outcome是一致的，</font><span style="color: rgb(227, 0, 0);">表示跳转到相应的节点。</span></div></div>
</div>
<hr>
<a name="1700"/>
<h1>11 JBPM各个类之间的关系</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><font color="#E30000">1、多种id之间的关系。</font><div><img src="JBPM_files/Image [45].png" type="image/png" style="cursor: default;cursor: default;"/></div><div><font color="#E30000">2、</font></div><div><img src="JBPM_files/Image [46].png" type="image/png" style="cursor: default;cursor: default;"/><img src="JBPM_files/Image [47].png" type="image/png" style="cursor: default;cursor: default;"/><img src="JBPM_files/Image [48].png" type="image/png" style="cursor: default;cursor: default;"/></div><div><font color="#6A0081">注：ProcessInstance继承自Execution类。</font></div></div>
</div>
<hr>
<a name="2090"/>
<h1>12 给任务的执行人赋值</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><font color="#E30000">1、一</font><span style="color: rgb(227, 0, 0);">个任务由固定的人执行</span><div><div><font color="#E30000"><br></font><div><font color="#E30000">2、一个任务可以动态的设置任务的执行人，但是在进入该任务之前</font></div><div><font color="#E30000">     通过流程变量赋值、在进入该节点之前必须赋值</font></div></div><div><span style="color: rgb(227, 0, 0);">代码：</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"> </span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">*</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">给任务的执行人赋值</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"> </span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">*</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>@author</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">administrator</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"> </span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">*</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"> </span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">*/</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">TaskTest</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>extends</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">BaseJbpm {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">@</span><span style="font-size: 10pt; background-color: rgb(212, 212, 212); background-position: initial initial; background-repeat: initial initial;">Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">testTable(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">            Configuration configuration =</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">Configuration();</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">            configuration.configure(</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;jbpm.hibernate.cfg.xml&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">            configuration.buildSessionFactory();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">@</span><span style="font-size: 10pt; background-color: rgb(212, 212, 212); background-position: initial initial; background-repeat: initial initial;">Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">testDeployFromClassPath(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">            </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">.getRepositoryService()</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">            .createDeployment()</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">            .addResourceFromClasspath(</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;qingjia.jpdl.xml&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">)</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">            .addResourceFromClasspath(</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;qingjia.png&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">)</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">            .deploy();</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">@</span><span style="font-size: 10pt; background-color: rgb(212, 212, 212); background-position: initial initial; background-repeat: initial initial;">Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">testStartPIByPDID(){</span></font></font></div><div align="left"><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">            </span></font><font color="#6A0081"> </font><font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">.getExecutionService()</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;">            .startProcessInstanceById(</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;qingjia-1&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">}</span></font></div><div><font color="#E30000"><br></font></div><div align="left"><font color="#E30000">执行结果：</font></div><div align="left"><img src="JBPM_files/Image [49].png" type="image/png" height="109" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="1013"/></div><div align="left"><br></div><div align="left"><font color="#E30000">代码：</font></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt; background-color: rgb(212, 212, 212); background-position: initial initial; background-repeat: initial initial;">testStartPIByPDID</span> <span style="font-size: 10pt;">(){</span></font></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><font color="#6A0081">      </font><font color="#328712">Map&lt;String,String&gt; variables =</font></span></font><font color="#328712"> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">HashMap&lt;String,String&gt;();</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;">      variables.put(</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;applicator&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">,</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;张三三&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">);</span></font></font></div><div align="left"><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">      </span></font><font color="#328712"> <font face="Courier New" size="2"><span style="font-size: 10pt;"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">.getExecutionService()</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;">      .startProcessInstanceById(</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;qingjia-1&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">,variables);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="JBPM_files/Image [50].png" type="image/png" height="51" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="1019"/></div></div><div align="left"><br></div></div><div><font color="#E30000">3、一个任务可以动态的设置任务的执行人，在进入该任务的时候指定</font></div><div><font color="#E30000">     ①可以采用程序的方式，给正在执行的任务设置任务的执行人</font></div><div><font color="#E30000">          assignTask</font></div><div align="left"><div><font color="#E30000">     </font><span style="color: rgb(227, 0, 0);">方式一：</span></div></div><div align="left" style="text-align: -webkit-left;"><font color="#3F5FBF" face="Courier New" size="2">     </font><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left" style="text-align: -webkit-left;"><font color="#6A0081"><font face="Courier New" size="2">     <span style="font-size: 10pt;"> </span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">*</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">在程序中设置任务的执行人</span></font></font></div><div align="left" style="text-align: -webkit-left;"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"> </span>     </font><span style="font-size: 10pt; font-family: 'Courier New';">*/</span></font></div><div align="left" style="text-align: -webkit-left;"><font color="#6A0081" face="Courier New" size="2">     <span style="font-size: 10pt;">@Test</span></font></div><div align="left" style="text-align: -webkit-left;"><font color="#6A0081"><font face="Courier New" size="2"><b>      </b></font><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt; background-color: rgb(212, 212, 212);">testAssignTask</span> <span style="font-size: 10pt;">(){</span></font></font></div><div align="left" style="text-align: -webkit-left;"><font color="#6A0081"><font face="Courier New" size="2">     <span style="font-size: 10pt;">      </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">.getTaskService().assignTask(</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;30001&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">,</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;dfsdf&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">);</span></font></font></div><div align="left" style="text-align: -webkit-left;"><font color="#6A0081" face="Courier New" size="2">     <span style="font-size: 10pt;">}</span></font></div><div><font color="#E30000">     ②写一个类，该类继承了AssignmentHandler接口，利用assignable.setAssignee(&quot;aaa&quot;);赋值</font></div><div><font color="#E30000">          在配置文件中，做相应的配置</font></div><div style="text-align: -webkit-left;"><font color="#E30000">     </font><span style="color: rgb(227, 0, 0); text-align: -webkit-left;">方式二：</span><font color="#E30000">    </font></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div align="left"><div align="left"><span style="color: rgb(227, 0, 0);">qingjia.jpdl.xml</span></div><div align="left"><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;?</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">xml</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">version</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;1.0&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">encoding</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;UTF-8&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">?&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">process</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;qingjia&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">xmlns</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;http://jbpm.org/4.4/jpdl&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">start</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;154,72,48,48&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;start1&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">     </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">transition</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;-69,-22&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;to 请假申请&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">to</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;请假申请&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">start</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">end</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;618,473,48,48&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;end1&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">task</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">assignee</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;#{applicator}&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;286,154,92,52&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;请假申请&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">     </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">transition</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;-93,-22&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;to 部门经理审批&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">to</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;部门经理审批&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">task</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">task</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">assignee</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;李四&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;481,225,92,52&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;部门经理审批&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">       </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">assignment-handler</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">class</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;cn.itheima.jbpm.test.MyAssignmentHandler&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">assignment-handler</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">     </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">transition</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;-81,-22&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;to 总经理审批&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">to</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;总经理审批&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">task</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">task</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">assignee</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;王五&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;367,379,92,52&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;总经理审批&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">     </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">transition</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;-50,-22&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;to end1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">to</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;end1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">task</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">process</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#008080" face="Courier New" size="2"><span style="font-size: 10pt;"><br></span></font></div></div><div align="left"><font color="#E30000">MyAssignmentHandler.java</font></div><div align="left"><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">MyAssignmentHandler</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>implements</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">AssignmentHandler {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">      </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">assign(Assignable assignable, OpenExecution execution)</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">                  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">Exception {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2">            //可以添加多个addCandidateUser</font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><font color="#6A0081">            </font><font color="#328712">assignable.addCandidateUser(</font></span></font><font color="#328712"> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;abc&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">);</span></font></font></div><div align="left"><div><font color="#328712" face="Courier New" size="2">            </font><font face="Courier New" size="2"><span style="font-size: 10pt;"><font color="#328712">assignable.addCandidateUser(</font></span></font><font color="#328712"> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;bca&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">);</span></font></font></div><div><font color="#328712" face="Courier New" size="2">            </font><font face="Courier New" size="2"><span style="font-size: 10pt;"><font color="#328712">assignable.addCandidateUser(</font></span></font><font color="#328712"> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;cba&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">);</span></font></font></div></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;"><br></span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><br></span></font></div></div><div align="left"><font color="#E30000">TaskTest.java</font></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size: 10pt; background-color: rgb(212, 212, 212); background-position: initial initial; background-repeat: initial initial;">testFinishTask</span> <span style="font-size: 10pt;">(){</span></font></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><font color="#6A0081">     </font><font color="#328712"> </font></span></font><font color="#328712"> <font face="Courier New" size="2"><span style="font-size: 10pt;"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">.getTaskService().completeTask(</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;30001&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">执行结果：</span></div><div><img src="JBPM_files/Image [51].png" type="image/png" height="55" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="950"/></div><div><font color="#E30000">注：如果需要为一个人分配多个任务，那么可以通过AssignmentHandler赋给同一个人。</font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;?</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">xml</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">version</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;1.0&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">encoding</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;UTF-8&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">?&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">process</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;qingjia&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">xmlns</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;http://jbpm.org/4.4/jpdl&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">start</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;154,72,48,48&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;start1&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">     </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">transition</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;-69,-22&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;to 请假申请&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">to</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;请假申请&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">start</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">end</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;618,473,48,48&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;end1&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">task</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">assignee</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;#{applicator}&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;286,154,92,52&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;请假申请&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">       </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">assignment-handler</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">class</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;cn.itheima.jbpm.test.MyAssignmentHandler&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">assignment-handler</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">     </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">transition</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;-93,-22&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;to 部门经理审批&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">to</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;部门经理审批&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">task</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">task</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">assignee</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;李四&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;481,225,92,52&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;部门经理审批&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;">       </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">assignment-handler</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">class</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;cn.itheima.jbpm.test.MyAssignmentHandler&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">assignment-handler</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">     </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">transition</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;-81,-22&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;to 总经理审批&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">to</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;总经理审批&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">task</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">task</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">assignee</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;王五&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;367,379,92,52&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;总经理审批&quot;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><font color="#6A0081"> </font><font color="#328712">      </font></span></font><font color="#328712"> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">assignment-handler</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">class</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&quot;cn.itheima.jbpm.test.MyAssignmentHandler&quot;</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">assignment-handler</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><font color="#328712"> </font><font color="#6A0081">    </font></span></font><font color="#6A0081"> </font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">transition</span></font><font color="#6A0081"> </font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">g</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">=</span></font><font color="#6A0081"> </font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">&quot;-50,-22&quot;</span></font><font color="#6A0081"> </font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">name</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">&quot;to end1&quot;</span></font><font color="#6A0081"> </font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">to</span></font><font color="#6A0081"> </font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">=</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">&quot;end1&quot;</span></font><font color="#6A0081"> </font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size: 10pt;">/&gt;</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">task</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">process</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#008080" face="Courier New" size="2"><span style="font-size: 10pt;"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0);">重点：增删改操作是绝对不能放在AssignmentHandler的实现类中完成的，因为AssignmentHandler是由JBPM进行调用的，所以它无法交给Spring进行管理然后由JBPM内部进行获取。也不能在这个类中设置Service属性，因为如果需要将这个Service交给Spring进行管理，那么就需要将AssignmentHandler交给Spring进行管理。这就是Spring 的缺点之一。</span></div></div><div align="left"><img src="JBPM_files/Image [52].png" type="image/png" height="343" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="788"/></div><div align="left"><br></div></div></div></div></blockquote><div align="left" style="text-align: -webkit-auto;"><div align="left"><div align="left"><div align="left"><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">4、一个任务可以有多个人完成，但是只要其中的一个人把该任务完成就完成了</span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">方式一：</span></div><div style="text-align: -webkit-auto;"><img src="JBPM_files/Image [53].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div style="text-align: -webkit-auto;"><br></div><div style="text-align: -webkit-auto;"><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;?</span></font><font face="Courier New" size="2"><span style="font-size:10pt">xml</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">version</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;1.0&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">encoding</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;UTF-8&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">?&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">process</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;grouptask&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">xmlns</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;http://jbpm.org/4.4/jpdl&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">start</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;start1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;255,46,48,48&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to 电脑维修&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;电脑维修&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-69,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">start</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">end</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;end1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;256,382,48,48&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;电脑维修&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;236,189,92,52&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">candidate-users</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;张三,李四,王五&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to end1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;end1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-50,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">process</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;"><br></span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">根据候选人查看组任务</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testQueryGroupTask</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;">      List&lt;Task&gt; taskList =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">      .findGroupTasks(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;张三&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(Task task:taskList){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(task.getName());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div></div><div align="left"><img src="JBPM_files/Image [54].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div align="left"><br></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testQueryGroupTask</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><font color="#6A0081"> </font><font color="#328712">     List&lt;Participation&gt; pList =</font></span></font> <font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">      .getTaskParticipations(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;10002&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);//任务号</span></font></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><font color="#328712"> </font><font color="#6A0081">     </font></span></font> <font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt"><b>for</b></span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">(Participation p:pList){</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(p.getUserId());</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div></div><div align="left"><img src="JBPM_files/Image [55].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div align="left"><br></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testTakeTask(){</span></font></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><font color="#6A0081"> </font><font color="#328712">     </font></span></font> <font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">      .takeTask(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;10002&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;张三&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div></div><div align="left"><img src="JBPM_files/Image [56].png" type="image/png" height="48" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="953"/></div><div align="left"><br></div><div align="left"><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">/**</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">该api除了能接受任务的候选人以外，什么人都能接受</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"> </span></font><font face="Courier New" size="2"><span style="font-size:10pt">*/</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testTakeTask(){</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService()</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      .takeTask(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;10002&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;ddddd&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">注：jbpm4_participation表也是一个临时表，一旦任务完成，数据也就消失了。</span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;"><br></span></div><div style="text-align: -webkit-auto;"><font color="#E30000">方式二：</font></div><div style="text-align: -webkit-auto;"><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">IdentityTest</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>extends</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">BaseJbpm {</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">@Test</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">testIdentity(){</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getIdentityService().createGroup(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;Row 1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getIdentityService().createGroup(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;Row 2&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#328712" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getIdentityService().createUser(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;User 1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;张三&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;张三&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getIdentityService().createUser(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;User 2&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;李四&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;李四&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#328712" face="Courier New" size="2"><span style="font-size:10pt">            </span></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getIdentityService().createMembership(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;User 1&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;Row 1&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getIdentityService().createMembership(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;User 2&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;Row 1&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div></div><div align="left"><font color="#E30000">jbpm4_id_group</font></div><div align="left"><img src="JBPM_files/Image [57].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div align="left"><br></div><div align="left"><font color="#E30000">jbpm4_id_user</font></div><div align="left"><img src="JBPM_files/Image [58].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div align="left"><br></div><div align="left"><div><span style="color: rgb(227, 0, 0);">jbpm4_id_membership</span></div><div><img src="JBPM_files/Image [59].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><br></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">MyAssignmentHandler</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>implements</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">AssignmentHandler {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">assign(Assignable assignable, OpenExecution execution)</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;">            assignable.addCandidateGroup(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;row 1&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">5、一个人要审批很多个任务--泳道</span></div><div><img src="JBPM_files/Image [60].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div><br></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">swimlane.jpdl.xml</span></div><div><img src="JBPM_files/Image [61].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;?</span></font><font face="Courier New" size="2"><span style="font-size:10pt">xml</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">version</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;1.0&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">encoding</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;UTF-8&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">?&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">process</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;swimlane&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">xmlns</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;http://jbpm.org/4.4/jpdl&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">start</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;start1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;156,46,48,48&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to task1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;task1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-52,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">start</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">  </span></font> <font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">swimlane</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;swimlane1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">candidate-users</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;aaa,bbb&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">swimlane</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font></font> <font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">end</span></font> <font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt"><i>&quot;end1&quot;</i></span></font> <font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt"><i>&quot;162,454,48,48&quot;</i></span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">/&gt;</span></font></div><div align="left"><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt"><i>&quot;task1&quot;</i></span></font> <font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt"><i>&quot;130,156,92,52&quot;</i></span></font> <font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;">swimlane</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;"><i>&quot;swimlane1&quot;</i></span></font></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">&gt;</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to task2&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;task2&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-52,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt"><i>&quot;task2&quot;</i></span></font> <font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt"><i>&quot;124,292,92,52&quot;</i></span></font> <font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;">swimlane</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size: 10pt;"><i>&quot;swimlane1&quot;</i></span></font></font><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">&gt;</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to end1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;end1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-50,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">process</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#008080" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：<br></span><img src="JBPM_files/Image [62].png" type="image/png" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;"/></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<hr>
<a name="365"/>
<h1>13 JBPM其他知识点</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><font color="#E30000">1、Decision</font><div><font color="#E30000">MyDecision.java </font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">MyDecision</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>implements</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">DecisionHandler {</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">String</span> <span style="font-size:10pt">decide(OpenExecution execution) {</span></font></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size: 10pt;"><font color="#6A0081">            </font><font color="#328712">Integer days = (Integer)execution.getVariable(</font></span></font> <font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">&quot;days&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>if</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">(days&lt;=3){</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4"><b>return</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">&quot;to end1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">;</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">            }</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>else</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">{</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">                  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4"><b>return</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">&quot;to task3&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">;</span></font></font></div><div align="left"><font color="#328712" face="Courier New" size="2"><span style="font-size: 10pt;">            }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">decision.jpdl.xml</span></div><div><img src="JBPM_files/Image [63].png" type="image/png" style="cursor: default;cursor: default;"/></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;?</span></font><font face="Courier New" size="2"><span style="font-size:10pt">xml</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">version</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;1.0&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">encoding</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;UTF-8&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">?&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">process</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;decision&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">xmlns</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;http://jbpm.org/4.4/jpdl&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">start</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;start1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;137,18,48,48&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;to task1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;task1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;-52,-22&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">start</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;task1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;120,117,92,52&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;to task2&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;task2&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;-52,-22&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;task2&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;119,216,92,52&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;to exclusive1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;exclusive1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;-79,-22&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;task3&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;30,387,92,52&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;to end1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;end1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;-50,-22&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">end</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;end1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;157,455,48,48&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font face="Courier New" size="2" style="color: rgb(106, 0, 129);"><span style="font-size:10pt">  </span></font> <font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">decision</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;exclusive1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;143,303,48,48&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">handler</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">class</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;cn.itheima.jbpm.decision.MyDecision&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">handler</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;to end1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;end1&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;-50,-22&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;to task3&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;task3&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;-52,-22&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">decision</span></font> <font face="Courier New" size="2"><span style="font-size: 10pt;">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">process</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#008080" face="Courier New" size="2"><br></font></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">DecisionTest.java</span></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size: 10pt;">@Test</span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">testFinishTask</span> <span style="font-size:10pt">(){</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;">      Map&lt;String,Integer&gt; variables =</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">HashMap&lt;String,Integer&gt;();</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">      variables.put(</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&quot;days&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, 1);</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.</span></font><font face="Courier New" size="2"><span style="font-size:10pt">getTaskService</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">().setVariables(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;20001&quot;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, variables);</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>processEngine</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.getTaskService().completeTask(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;20001&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt">}</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">2、Forkjoin </span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">forkjoin.jpdl.xml</span></div><div><img src="JBPM_files/Image [64].png" type="image/png" style="cursor: default;cursor: default;"/></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;?</span></font><font face="Courier New" size="2"><span style="font-size:10pt">xml</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">version</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;1.0&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">encoding</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;UTF-8&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">?&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">process</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;forkjoin&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">xmlns</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;http://jbpm.org/4.4/jpdl&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">start</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;start1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;161,37,48,48&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to fork1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;fork1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-52,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">start</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">end</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;end1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;171,472,48,48&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">fork</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;fork1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;165,121,48,48&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to task1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;task1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-52,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to task2&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;task2&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-52,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">fork</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">join</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;join1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;172,405,48,48&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to end1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;end1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-50,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">join</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;task1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;99,201,92,52&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">assignee</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;aa&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to task3&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;task3&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-52,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;task2&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;241,201,92,52&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">assignee</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;bb&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to task4&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;task4&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-52,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;task3&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;104,306,92,52&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">assignee</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;bb&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to join1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;join1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-49,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;task4&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;240,296,92,52&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">assignee</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;aa&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to join1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;join1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-49,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">process</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#008080" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">执行结果：</span></div><div><img src="JBPM_files/Image [65].png" type="image/png" height="147" style="cursor: default;cursor: default;" width="1212"/></div><div><br></div><div><br></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">3、事件</span></div><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">流程级别的事件</span></div><div><span style="text-align: -webkit-auto;"><font color="#E30000">     流程的开始事件</font></span></div><div><span style="text-align: -webkit-auto;"><font color="#E30000">     流程的结束事件</font></span></div><div><span style="text-align: -webkit-auto;"><font color="#E30000">节点级别的事件</font></span></div><div><span style="text-align: -webkit-auto;"><font color="#E30000">     开始节点的结束事件</font></span></div><div><span style="text-align: -webkit-auto;"><font color="#E30000">     结束节点的开始事件</font></span></div><div><span style="text-align: -webkit-auto;"><font color="#E30000">     一般节点的开始事件和结束事件</font></span></div><div><span style="text-align: -webkit-auto;"><font color="#E30000"><br></font></span></div><div><span style="text-align: -webkit-auto;"><font color="#E30000">事件的触发流程：</font></span></div><div><span style="text-align: -webkit-auto;"><font color="#E30000">流程的开始事件——&gt;开始节点的结束事件——&gt;一般节点的开始事件——&gt;一般节点的结束事件——&gt;结束节点的开始事件——&gt;流程的结束事件</font></span></div><div><span style="text-align: -webkit-auto;"><font color="#E30000"><br></font></span></div><div style="text-align: -webkit-auto;"><font color="#E30000">event.jpdl.xml </font></div><div style="text-align: -webkit-auto;"><img src="JBPM_files/Image [66].png" type="image/png" style="cursor: default;cursor: default;"/></div><div style="text-align: -webkit-auto;"><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size: 10pt;">&lt;?</span></font><font face="Courier New" size="2"><span style="font-size:10pt">xml</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">version</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;1.0&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">encoding</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;UTF-8&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">?&gt;</span></font></font></div><div align="left"><font color="#6A0081" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">process</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;evnt&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">xmlns</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;http://jbpm.org/4.4/jpdl&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;!-- 流程的开始事件--&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">on</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">event</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;start&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">event-listener</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">class</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;cn.itheima.jpbm.event.ProcessStartEvent&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">event-listener</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">on</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">   </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;!-- 流程的结束事件--&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">on</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">event</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;end&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">event-listener</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">class</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;cn.itheima.jpbm.event.ProcessEndEvent&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">event-listener</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">on</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"> </span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">start</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;start1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;219,43,48,48&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;!-- 开始节点的结束事件 --&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">on</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">event</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;end&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">event-listener</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">class</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;cn.itheima.jpbm.event.StartNodeEndEvent&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">event-listener</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">on</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to task1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;task1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-52,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">start</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">end</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;end1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;206,396,48,48&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;!-- 结束节点的开始事件 --&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">on</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">event</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;start&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">event-listener</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">class</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;cn.itheima.jpbm.event.EndNodeStartEvent&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">event-listener</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">on</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">end</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;task1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;187,205,92,52&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;!-- 一般节点的开始事件 --&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">on</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">event</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;start&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">event-listener</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">class</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;cn.itheima.jpbm.event.NodeStartEvent&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">event-listener</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">on</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;!-- 一般节点的结束事件 --&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">on</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">event</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;start&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">event-listener</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">class</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;cn.itheima.jpbm.event.NodeEndEvent&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">event-listener</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">       </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">on</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">     </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;</span></font><font face="Courier New" size="2"><span style="font-size:10pt">transition</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">name</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;to end1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">to</span></font><font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;end1&quot;</i></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">g</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font><font face="Courier New" size="2"><span style="font-size:10pt"><i>&quot;-50,-22&quot;</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">/&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">  </span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">task</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#6A0081"><font face="Courier New" size="2"><span style="font-size:10pt">&lt;/</span></font><font face="Courier New" size="2"><span style="font-size:10pt">process</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&gt;</span></font></font></div><div align="left"><font color="#008080" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><div><span style="color: rgb(227, 0, 0); text-align: -webkit-auto;">ProcessStartEvent.java</span></div></div><div align="left"><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size: 10pt;"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>class</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">ProcessStartEvent</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>implements</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">EventListener {</span></font></font></div><div align="left"><font color="#328712" face="Courier New" size="2"><span style="font-size:10pt"><br></span></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">notify(EventListenerExecution execution)</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">Exception {</span></font></font></div><div align="left"><font color="#328712"><font face="Courier New" size="2"><span style="font-size:10pt">            System.</span></font> <font face="Courier New" size="2"><span style="font-size:10pt"><i>out</i></span></font><font face="Courier New" size="2"><span style="font-size:10pt">.println(</span></font><font face="Courier New" size="2"><span style="font-size:10pt">&quot;dfff&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></font></div><div align="left"><font color="#328712" face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font color="#328712" face="Courier New" size="2"><span style="font-size: 10pt;">}</span></font></div><div align="left" style="text-align: -webkit-auto;"><font color="#E30000"><br></font></div><div align="left" style="text-align: -webkit-auto;"><font color="#E30000">Decision和Event都是为了实现控制和业务的松耦合。</font></div><div align="left" style="text-align: -webkit-auto;"><img src="JBPM_files/Image [67].png" type="image/png" style="cursor: default;cursor: default;"/></div></div></div></div></div></div></div>
</div></body></html> 